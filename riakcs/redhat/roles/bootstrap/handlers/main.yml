---
- name: update sysctl
  command: sysctl -e -p /etc/sysctl.d/riak.conf

- name: source rclocal
  command: /bin/bash /etc/rc.local

- name: restart iptables
  service: name=iptables state=restarted

- name: fetch yum repository
  get_url: url=http://yum.basho.com/gpg/basho-release-6-1.noarch.rpm dest=/tmp

- name: configure the basho repository
  yum: name=/tmp/basho-release-6-1.noarch.rpm

- name: configure iptables
  template: src=../../common/templates/iptables.j2 dest=/etc/sysconfig/iptables owner=root group=root
  notify:
  - restart iptables

#install packages outside of roles because they are cross dependent
- name: install riak, riakcs
  yum: name=$item state=present
  with_items:
  - riak
  - riak-cs